<% if !comment.parent_id %>
<li class="list-group-item" style="margin-bottom: 20px;"> 
  <div>
    <% @username = User.find(comment.user_id).username %>
    <span style="background-color:#EDEFF1;color:#1A1A1B;font-size:13px"><%= link_to "#{@username}", user_path(comment.user_id) %></span>      
  </div>
  <div>
    <span style="color:#1A1A1B;font-size: 15px"><%= comment.message %></span>
  </div>

  <div>
    <% if current_user %>
      <% if current_user.comment_votes.where(:comment_id => comment.id, :up => true).present? %>
        <span style="font-size: 1.0rem;">
          <i class="fa fa-arrow-up" aria-hidden="true"></i>
        </span>
      <% else %>
        <%= link_to comment_votes_path(:comment_vote => {:comment_id => comment.id, :up => true, :user_id => current_user.id}), :method => :post do %>
          <span style="font-size: 1.0rem;">
            <i class="fa fa-arrow-up" aria-hidden="true"></i>
          </span>
        <% end %>
      <% end %>

      <% if current_user.comment_votes.where(:comment_id => comment.id, :up => false).present? %>
        <span style="font-size: 1.0rem;">
          <i class="fa fa-arrow-down" aria-hidden="true"></i>
        </span>
      <% else %>
        <%= link_to comment_votes_path(:comment_vote => {:comment_id => comment.id, :up => false, :user_id => current_user.id}), :method => :post do %>
          <span style="font-size: 1.0rem;">
            <i class="fa fa-arrow-down" aria-hidden="true"></i>
          </span>
        <% end %>
    <% end %>

    <% else %>
      <span style="font-size: 1.0rem;">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
        <i class="fa fa-arrow-down" aria-hidden="true"></i>
      </span>
    <% end %>
  </div>

    <span style="font-size: 13px">Votes: <%= comment.comment_votes.where(:up => true).count - comment.comment_votes.where(:up => false).count %></span>
    <% if current_user %>
      <div style="font-size: 15px;"><%= link_to "Reply", new_reply_path(:comment => comment, :link => @link) %></div>

      <% else %>
      <div style="font-size: 15px;"><%= link_to 'Sign In', new_user_session_path %> <%= " to reply" %></div>   
    <% end %> 
</li>


<% if Comment.where(parent_id: comment.id).exists? %>
  <div>
      <% Comment.where(parent_id: comment.id).each do |comment| %>  
        <li class="list-group-item" style="margin-bottom: 20px;">         
          <span style="color:#1A1A1B;font-size: 15px"><%= comment.message %></span>
        </li>
      <% end %>
  </div>        
<% end %>
<% end %>